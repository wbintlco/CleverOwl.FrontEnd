
@{
    ViewBag.Title = "LocalizationFileUpload";
}


@using RLI.Common.Managers

@{
    Dictionary<string, string> Locale = ViewBag.Locale;
}
@Styles.Render("~/assets/vendors/custom/datatables/datatables.bundle.css")
<title>@Html.Raw(UtilitiesManager.GetFieldLabel(Locale, "LocalizationFileUploadPageLocalizationFileUpload"))</title>
<style>
    input[type="file"] {
        display: none;
    }

    #overlay {
        position: fixed; /* Sit on top of the page content */
        width: 100%; /* Full width (cover the whole page) */
        height: 100%; /* Full height (cover the whole page) */
        top: 0;
        left: 0;
        right: 0;
        bottom: 0; 
        background-color: rgba(0,0,0,0.5); /* Black background with opacity */

        z-index: 999999; /* Specify a stack order in case you're using a different order for other elements */
        cursor: pointer; /* Add a pointer on hover */
    }

    .text {
        font-size: 20px;
        color: white;
    }

    .m-portlet__head1 {
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-orient: horizontal;
        -webkit-box-direction: normal;
        -ms-flex-direction: row;
        flex-direction: row;
        -webkit-box-align: stretch;
        -ms-flex-align: stretch;
        align-items: stretch;
        -webkit-box-pack: justify;
        -ms-flex-pack: justify;
        justify-content: space-between;
        padding: 0;
        padding: 0 2.2rem;
        height: 5.1rem;
        position: relative;
    }

    .m-portlet1 {
        box-shadow: 0px 1px 15px 1px rgb(69 65 78 / 8%);
    }

    .m-portlet__body1 {
    }
</style>

<div id="overlay" onclick="">
    <div id="indicator_0" style="height:150px;">
        <div id="profile" class="row" style="margin-top:60px;">
            <div class="col-9"></div>
            <div class="col-3 text-white" style="transform:scaleY(4)"><i class="fas fa-long-arrow-alt-up"></i></div>
        </div>
        <div class="row" style="margin-top:7px">
            <div class="col-9"></div>
            <div class="col-3 text-white">Here's where you can access your profile and pinborad</div>
        </div>
    </div>
    <div id="indicator_1" style="height:150px; display:none">
        <div id="profile" class="row" style="margin-top:60px; ">
            <div class="col-4"></div>
            <div class="col-3 text-white" style="transform:scaleY(4)"><i class="fas fa-long-arrow-alt-up"></i></div>
        </div>
        <div class="row" style="margin-top:10px">
            <div class="col-4"></div>
            <div class="col-3 text-white">Click here to explore the 5 ways of learning</div>
        </div>
    </div>
    <div id="indicator_2" style="height:150px;  display:none">
        <div id="profile" class="row" style="margin-top:60px;">
            <div class="col-10"></div>
            <div class="col-2 text-white" style="transform:scaleY(4)"><i class="fas fa-long-arrow-alt-up"></i></div>
        </div>
        <div class="row" style="margin-top:7px">
            <div class="col-9"></div>
            <div class="col-3 text-white">Choose the language you want from here</div>
        </div>
    </div>
    <div id="indicator_3" style="height:150px; display:none">
        <div id="profile" class="row" style="margin-top:60px;">
            <div class="col-11"></div>
            <div class="col-1 text-white" style="transform:scaleY(4)"><i class="fas fa-long-arrow-alt-up"></i></div>
        </div>
        <div class="row" style="margin-top:7px">
            <div class="col-10"></div>
            <div class="col-2 text-white">Check you notifications here to stay updated!</div>
        </div>
    </div>
    <div id="indicator_4" style="height:150px; display:none">
        <div id="profile" class="row" style="margin-top:60px">
            <div class="col-3 text-white" style="margin-left:15px; transform:scaleY(4)"><i class="fas fa-long-arrow-alt-up"></i></div>
        </div>
        <div class="row" style="margin-top:10px">
            <div class="col-3 text-white">The menu refers to the different sections of the platform</div>
        </div>
    </div>
    <div id="carousel-example-1z" class="carousel slide carousel-fade" data-ride="carousel" style="height:150px" data-interval="false" data-next="false">

        <!--Indicators-->
        <ol class="carousel-indicators">
            <li id="carousel_0" data-target="#carousel-example-1z" data-slide-to="0" class="active"></li>
            <li id="carousel_1" data-target="#carousel-example-1z" data-slide-to="1"></li>
            <li id="carousel_2" data-target="#carousel-example-1z" data-slide-to="2"></li>
            <li id="carousel_3" data-target="#carousel-example-1z" data-slide-to="3"></li>
            <li id="carousel_4" data-target="#carousel-example-1z" data-slide-to="4"></li>
        </ol>
        <!--/.Indicators-->
        <!--Slides-->
        <div class="carousel-inner" role="listbox">

            <!--First slide-->
            <div class="carousel-item">
                <div class="view">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="top:90%">
                        <!-- Content -->
                        <div class="text-center mx-5 wow fadeIn">
                            <h3 class="text-info" style="color:#0E8BF2">
                                Quick Tutorial
                            </h3>
                            <p class="text-white">Profile</p>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->

                </div>
            </div>
            <!--/First slide-->
            <!--Second slide-->
            <div class="carousel-item">
                <div class="view">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="top:90%">

                        <!-- Content -->
                        <div class="text-center mx-5 wow fadeIn">
                            <h3 style="color:#0E8BF2">
                                Quick Tutorial
                            </h3>
                            <p class="text-white">Way of learning</p>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->

                </div>
            </div>
            <!--/Second slide-->
            <!--Third slide-->
            <div class="carousel-item">
                <div class="view">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="top:50%">

                        <!-- Content -->
                        <div class="text-center mx-5 wow fadeIn">
                            <h3 style="color:#0E8BF2">
                                Quick Tutorial
                            </h3>
                            <p class="text-white">Languages</p>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->
                </div>
            </div>
            <!--/Third slide-->
            <!--Fourth slide-->
            <div class="carousel-item">
                <div class="view">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="top:50%">

                        <!-- Content -->
                        <div class="text-center mx-5 wow fadeIn">
                            <h3 style="color:#0E8BF2">
                                Quick Tutorial
                            </h3>
                            <p class="text-white">Notifications</p>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->
                </div>
            </div>
            <!--/Fourth slide-->
            <!--Fifth slide-->
            <div class="carousel-item">
                <div class="view">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center" style="top:50%">

                        <!-- Content -->
                        <div class="text-center mx-5 wow fadeIn">
                            <h3 style="color:#0E8BF2">
                                Quick Tutorial
                            </h3>
                            <p class="text-white">Menu</p>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->
                </div>
            </div>
            <!--/Fifth slide-->
        </div>
        <!--/.Slides-->
        <!--Controls-->
        <a id="slide_prev_btn" class="carousel-control-prev" href="#carousel-example-1z" role="button">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a id="slide_next_btn" class="carousel-control-next" href="#carousel-example-1z" role="button">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
        <!--/.Controls-->

    </div>
    <div class="row closeOverlay" style="position:relative; display:none;">
        <div class="col-5"></div>
        <div class="col-2">
            <label class="m-radio m-radio--state-success" style="color:white">
                <input type="radio" name="example_2" value="1"> Understood, please don't show this tutorial agian
                <span></span>
            </label>

        </div>
        <div class="col-5"></div>
    </div>
    <div class="row closeOverlay" style="position:relative; display:none;">
        <div class="col-5"></div>
        <div class="col-2"><div id="closeOverlayBtn" class="btn m-btn--pill btn-success m-btn m-btn--outline-2x w-100 ">done</div></div>
        <div class="col-5"></div>
    </div>

</div>
<div class="m-portlet m-portlet--mobile">

    <div class="m-portlet__head">
        <div class="m-portlet__head-caption">
            <div class="m-portlet__head-title">
                <h3 class="m-portlet__head-text">
                    @Html.Raw(UtilitiesManager.GetFieldLabel(Locale, "LocalizationFileUploadPageLocalizationFileUpload"))
                </h3>
            </div>
        </div>
        <div class="m-portlet__head-tools">
            <div class="m-portlet__nav">
                <div class="m-portlet__nav-item">
                    <label class="m-portlet__nav-link btn m-btn--pill btn-outline-success m-btn m-btn--outline-2x w-100">
                        <input type="file" id="selectedFile" />
                        <i style="padding-right:5px" class="fas fa-cloud-upload-alt"></i>@Html.Raw(UtilitiesManager.GetFieldLabel(Locale, "LocalizationFileUploadPageUpload"))
                    </label>
                </div>
            </div>
        </div>

    </div>
    <div id="body" class="m-portlet__body" style="padding:10px;">
        <table class="table table-striped- table-bordered table-hover table-checkable dataTable no-footer dtr-inline"
               id="m_table" role="grid">
            <thead>
                <tr>
                    <th>Controller</th>
                    <th>Action</th>
                    <th>FieldKey</th>
                    <th>English</th>
                    <th>Arabic</th>
                    <th>French</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>

    </div>
    <div class="m-portlet__foot" style="padding:10px">
        <div class="row">
            <div class="col-6"></div>
            <div class="col-3">
                <div id="save_btn" class="m-portlet__nav-link btn m-btn--pill btn-outline-primary m-btn m-btn--outline-2x w-100">
                    <div>@Html.Raw(UtilitiesManager.GetFieldLabel(Locale, "LocalizationFileUploadPageSave"))</div>
                </div>
            </div>
            <div class="col-3">
                <div id="cancelBtn_" class="m-portlet__nav-link btn m-btn--pill btn-outline-metal m-btn m-btn--outline-2x w-100">
                    <div class="m--font-metal">@Html.Raw(UtilitiesManager.GetFieldLabel(Locale, "LocalizationFileUploadPageCancel"))</div>
                </div>
            </div>
        </div>
    </div>
</div>
@using (Html.BeginForm("SaveFile", "LocalisationTest", FormMethod.Post, new { id = "SaveHidden", @class = "", @style = "display:none;" }))
{
    @Html.AntiForgeryToken()
    @Html.Hidden("jsonData", "")
}

@section Scripts {

    <!--begin::Page Vendors -->
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/assets/vendors/custom/datatables/datatables.bundle.js")

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
    <script>

        $(window).resize(function () {
            $('#body1').height($('#body').height())


        });
        function on() {
            document.getElementById("overlay").style.display = "block";
        }

        function off() {
            document.getElementById("overlay").style.display = "none";
        }

        var table;
        initTable("[]");
        function initTable(data) {
            table = $('#m_table').DataTable({
                "data": JSON.parse(data),
                "columns": [
                    { "data": "Controller" },
                    { "data": "Action" },
                    { "data": "FieldKey" },
                    { "data": "English" },
                    { "data": "Arabic" },
                    { "data": "French" }
                ]
            });
        }
        let selectedFile;
        var json = "";
        document.getElementById('selectedFile').addEventListener("change", (event) => {
            selectedFile = event.target.files[0];
            if (selectedFile) {
                let fileReader = new FileReader();
                fileReader.readAsBinaryString(selectedFile);
                fileReader.onload = (event) => {
                    let data = event.target.result;
                    let workbook = XLSX.read(data, { type: "binary" });
                    workbook.SheetNames.forEach(sheet => {
                        let rowObject = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet]);

                        json = JSON.stringify(rowObject, undefined, 4);


                    });
                }
                fileReader.onloadend = (event) => {
                    if (json) {
                        console.log(json);
                        table.destroy();
                        initTable(json);

                    }
                }

            }

        });

        $(document).ready(function () {
            $('.carousel').carousel({

            });

            var slide_to_index = 0;

            $('#slide_prev_btn').hide();
            $('#slide_next_btn').click(function () {


                mApp.block($('#overlay'));
                $('#slide_prev_btn').show();
                if (slide_to_index < 5) {
                    $('#indicator_' + slide_to_index).hide();
                    $('#carousel_' + slide_to_index).removeClass("active");
                    ++slide_to_index;
                    $('#carousel_' + slide_to_index).addClass("active");
                    $('#indicator_' + slide_to_index).show();
                }
                if (slide_to_index == 4) {
                    $('#slide_next_btn').hide();
                    $('.closeOverlay').show();
                }
                clickAccepted = true;

                mApp.unblock($('#overlay'));

            });
            $('#slide_prev_btn').click(function () {
                if (clickAccepted == true) {
                    clickAccepted = false;
                    mApp.block($('#overlay'));
                    $('#slide_next_btn').show();
                    $('.closeOverlay').hide();
                    if (slide_to_index > 0) {
                        $('#indicator_' + slide_to_index).hide();
                        $('#carousel_' + slide_to_index).removeClass("active");
                        --slide_to_index;
                        $('#carousel_' + slide_to_index).addClass("active");
                        $('#indicator_' + slide_to_index).show();
                    }
                    if (slide_to_index == 0) {
                        $('#slide_prev_btn').hide();
                    }
                    clickAccepted = true;
                    mApp.unblock($('#overlay'));
                }
            });
            $('#closeOverlayBtn').click(function () {
                $('#overlay').remove();
            });
            $('#save_btn').on('click', function () {
                if (json) {
                    $("#jsonData").val(json);
                    $("#SaveHidden").ajaxSubmit({
                        beforeSubmit: function () {
                        },
                        success: function (data) {
                            console.log(data.result);
                            if (data == 200) {
                                swal("SUCCESS", "Localisation success", "succes.");
                                json = "";
                                table.clear().draw();
                            } else if (data == 404) {
                                swal("Error", " Error in localisation", "error.");
                            }
                        },
                        error: function (xhr, status, error) {
                            console.log("Error In SaveHidden !!!!!!!");
                        }
                    });

                    json = "";
                }
            });

            $('#cancelBtn_').on('click', function () {
                json = "";
                table.clear().draw();
            });

        });

    </script>

}

